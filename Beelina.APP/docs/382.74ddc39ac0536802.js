"use strict";(self.webpackChunkBeelina_APP=self.webpackChunkBeelina_APP||[]).push([[382],{8416:(R,E,n)=>{n.r(E),n.d(E,{ProfileModule:()=>k});var t=n(6223),f=n(617),c=n(2032),p=n(9515),O=n(2939),h=n(6814),I=n(6924),v=n(4190),S=n(2006),g=n(8897),e=n(5879),_=n(6618),o=n(5253),l=n(8180),s=n(7398),A=n(6306),N=n(2096);let T=(()=>{class a{constructor(r){this.authService=r,this.userId=0}validate(r){return this.authService.checkUsernameExists(this.userId,r.value).pipe((0,l.q)(1),(0,s.U)(i=>i?{usernameAlreadyExists:!0}:null),(0,A.K)(()=>(0,N.of)(null)))}static#e=this.\u0275fac=function(i){return new(i||a)(e.\u0275\u0275inject(_.e))};static#t=this.\u0275prov=e.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var B=n(6610),F=n(3427),M=n(2296),P=n(4170);function b(a,C){1&a&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"PROFILE_PAGE.FORM_CONTROL_SECTION.EMAIL_CONTROL.INVALID_EMAIL_ERROR_MESSAGE")," "))}function x(a,C){1&a&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"PROFILE_PAGE.FORM_CONTROL_SECTION.USERNAME_CONTROL.ALREADY_EXIST_ERROR_MESSAGE")," "))}function D(a,C){1&a&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"PROFILE_PAGE.FORM_CONTROL_SECTION.NEW_PASSWORD_CONTROL.PASSWORD_NOT_STRONG_ERROR_MESSAGE")," "))}const G=[{path:"",component:(()=>{class a extends g.H{constructor(r,i,m,u,j,U){super(),this.authService=r,this.formBuilder=i,this.dialogService=m,this.snackBarService=u,this.translateService=j,this.uniqueUsernameValidator=U,this._profileForm=this.formBuilder.group({firstName:["",t.kI.required],middleName:[""],lastName:["",t.kI.required],emailAddress:["",[t.kI.required,t.kI.email]],username:["",[t.kI.required],[this.uniqueUsernameValidator.validate.bind(this.uniqueUsernameValidator)]],newPassword:["",[t.kI.pattern("^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*?&#])[A-Za-z\\d@$!%*?&#]{8,}$")]]},{updateOn:"blur"});const L=this.authService.userId;this.uniqueUsernameValidator.userId=L,this.authService.getUserInformation(L).subscribe(d=>{this._userDetails=d,this._profileForm.get("firstName").setValue(d.firstName),this._profileForm.get("middleName").setValue(d.middleName),this._profileForm.get("lastName").setValue(d.lastName),this._profileForm.get("emailAddress").setValue(d.emailAddress),this._profileForm.get("username").setValue(d.username)})}ngOnInit(){}profileHasChanged(){return this._profileForm.get("firstName").value!==this._userDetails.firstName||this._profileForm.get("middleName").value!==this._userDetails.middleName||this._profileForm.get("lastName").value!==this._userDetails.lastName||this._profileForm.get("emailAddress").value!==this._userDetails.emailAddress||this._profileForm.get("username").value!==this._userDetails.username||""!==this._profileForm.get("newPassword").value}saveProfile(){if(this._profileForm.markAllAsTouched(),this._profileForm.valid&&this.profileHasChanged()){const r=new S.n;r.id=this.authService.userId,r.firstName=this._profileForm.get("firstName").value,r.middleName=this._profileForm.get("middleName").value,r.lastName=this._profileForm.get("lastName").value,r.emailAddress=this._profileForm.get("emailAddress").value,r.username=this._profileForm.get("username").value,r.password=this._profileForm.get("newPassword").value,r.userPermissions=this._userDetails.userPermissions.map(i=>({id:i.id,moduleId:i.moduleId,permissionLevel:i.permissionLevel})),this.dialogService.openConfirmation(this.translateService.instant("PROFILE_PAGE.EDIT_PROFILE_DIALOG.TITLE"),this.translateService.instant("PROFILE_PAGE.EDIT_PROFILE_DIALOG.CONFIRM")).subscribe(i=>{i&&(this._isLoading=!0,this.authService.updateAccountInformation(r).subscribe({next:()=>{this._isLoading=!1,this._userDetails=r,this.snackBarService.open(this.translateService.instant("PROFILE_PAGE.EDIT_PROFILE_DIALOG.SUCCESS_MESSAGE"),this.translateService.instant("GENERAL_TEXTS.CLOSE")),this.authService.refresh().subscribe()},error:m=>{this._isLoading=!1,this.snackBarService.open(this.translateService.instant("PROFILE_PAGE.EDIT_PROFILE_DIALOG.ERROR_MESSAGE"),this.translateService.instant("GENERAL_TEXTS.CLOSE"))}}))})}}get profileForm(){return this._profileForm}static#e=this.\u0275fac=function(i){return new(i||a)(e.\u0275\u0275directiveInject(_.e),e.\u0275\u0275directiveInject(t.qu),e.\u0275\u0275directiveInject(o.x),e.\u0275\u0275directiveInject(O.ux),e.\u0275\u0275directiveInject(p.sK),e.\u0275\u0275directiveInject(T))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-profile"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:55,vars:36,consts:[[3,"title","showBackButton"],["mat-icon-button","",1,"toolbar-option",3,"click"],[3,"busy"],[1,"page-container","slide-in-left-animation"],[1,"page-container__page-divider","scale-in-center-animation"],[1,"page-information-description"],[1,"panel"],[1,"panel__details-group-panel",3,"formGroup"],[1,"panel__header-section"],[1,"panel__body-section"],["appearance","fill"],["matInput","","type","text","formControlName","firstName"],["matInput","","type","text","formControlName","middleName"],["matInput","","type","text","formControlName","lastName"],["matInput","","type","email","formControlName","emailAddress"],[4,"ngIf"],["matInput","","type","email","formControlName","username"],["matInput","","type","password","formControlName","newPassword"]],template:function(i,m){if(1&i&&(e.\u0275\u0275elementStart(0,"app-tool-bar",0),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"button",1),e.\u0275\u0275listener("click",function(){return m.saveProfile()}),e.\u0275\u0275elementStart(3,"mat-icon"),e.\u0275\u0275text(4,"save"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(5,"app-loader-layout",2)(6,"div",3)(7,"div",4)(8,"label"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"br"),e.\u0275\u0275elementStart(12,"span",5),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(15,"div",6)(16,"div",7)(17,"div",8)(18,"label"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"div",9)(22,"mat-form-field",10)(23,"mat-label"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(26,"input",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"mat-form-field",10)(28,"mat-label"),e.\u0275\u0275text(29),e.\u0275\u0275pipe(30,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(31,"input",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"mat-form-field",10)(33,"mat-label"),e.\u0275\u0275text(34),e.\u0275\u0275pipe(35,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(36,"input",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"mat-form-field",10)(38,"mat-label"),e.\u0275\u0275text(39),e.\u0275\u0275pipe(40,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(41,"input",14),e.\u0275\u0275template(42,b,3,3,"mat-error",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(43,"mat-form-field",10)(44,"mat-label"),e.\u0275\u0275text(45),e.\u0275\u0275pipe(46,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(47,"input",16),e.\u0275\u0275template(48,x,3,3,"mat-error",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(49,"mat-form-field",10)(50,"mat-label"),e.\u0275\u0275text(51),e.\u0275\u0275pipe(52,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(53,"input",17),e.\u0275\u0275template(54,D,3,3,"mat-error",15),e.\u0275\u0275elementEnd()()()()()()),2&i){let u;e.\u0275\u0275property("title",e.\u0275\u0275pipeBind1(1,16,"GENERAL_TEXTS.BEELINA"))("showBackButton",!1),e.\u0275\u0275advance(5),e.\u0275\u0275property("busy",m.isLoading),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,18,"PROFILE_PAGE.TITLE")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,20,"PROFILE_PAGE.DESCRIPTION")),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",m.profileForm),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(20,22,"PROFILE_PAGE.FORM_CONTROL_SECTION.HEADER_TITLE")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(25,24,"PROFILE_PAGE.FORM_CONTROL_SECTION.FIRSTNAME_CONTROL.LABEL"),":"),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(30,26,"PROFILE_PAGE.FORM_CONTROL_SECTION.MIDDLENAME_CONTROL.LABEL"),":"),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(35,28,"PROFILE_PAGE.FORM_CONTROL_SECTION.LASTNAME_CONTROL.LABEL"),":"),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(40,30,"PROFILE_PAGE.FORM_CONTROL_SECTION.EMAIL_CONTROL.LABEL"),":"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",m.profileForm.get("emailAddress").hasError("email")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(46,32,"PROFILE_PAGE.FORM_CONTROL_SECTION.USERNAME_CONTROL.LABEL"),":"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",null==(u=m.profileForm.get("username"))?null:u.hasError("usernameAlreadyExists")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(52,34,"PROFILE_PAGE.FORM_CONTROL_SECTION.NEW_PASSWORD_CONTROL.LABEL"),":"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",m.profileForm.get("newPassword").hasError("pattern"))}},dependencies:[h.O5,B.l,F.o,M.RK,f.Hw,c.Nt,P.KE,P.hX,P.TO,t.Fj,t.JJ,t.JL,t.sg,t.u,p.X$]})}return a})(),title:"PROFILE_PAGE.TITLE"}];let y=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:a});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[v.Bz.forChild(G),v.Bz]})}return a})(),k=(()=>{class a{static#e=this.\u0275fac=function(i){return new(i||a)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:a});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[h.ez,I._,c.c,f.Ps,O.ZX,y,t.UX,p.aw.forChild()]})}return a})()},3427:(R,E,n)=>{n.d(E,{o:()=>g});var t=n(5879),f=n(7084),c=n(6814),p=n(2296),O=n(617),h=n(1274);function I(e,_){if(1&e){const o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",3),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(o);const s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.toggleDrawer())}),t.\u0275\u0275elementStart(1,"mat-icon",4),t.\u0275\u0275text(2,"menu"),t.\u0275\u0275elementEnd()()}}function v(e,_){if(1&e){const o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",3),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(o);const s=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(s.onGoBack())}),t.\u0275\u0275elementStart(1,"mat-icon",4),t.\u0275\u0275text(2,"keyboard_arrow_left"),t.\u0275\u0275elementEnd()()}}const S=["*"];let g=(()=>{class e{constructor(o,l){this.uiService=o,this.location=l,this.title="",this.showBackButton=!0,this.overrideBackAction=!1,this.onGoBackOverride=new t.EventEmitter,this._isHandset=!1}ngOnInit(){}ngOnDestroy(){this.isHandSetSubscription&&this.isHandSetSubscription?.unsubscribe()}toggleDrawer(){this.uiService.toggleDrawer()}onGoBack(){this.overrideBackAction?this.onGoBackOverride.emit():this.location.back()}ngAfterContentChecked(){this.isHandSetSubscription=this.uiService.isHandset.subscribe(o=>{this._isHandset=o})}get canGoBack(){return this.showBackButton}get isHandset(){return this._isHandset}static#e=this.\u0275fac=function(l){return new(l||e)(t.\u0275\u0275directiveInject(f.V),t.\u0275\u0275directiveInject(c.Ye))};static#t=this.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["app-tool-bar"]],inputs:{title:"title",showBackButton:"showBackButton",overrideBackAction:"overrideBackAction"},outputs:{onGoBackOverride:"onGoBackOverride"},ngContentSelectors:S,decls:7,vars:3,consts:[["type","button","mat-icon-button","",3,"click",4,"ngIf"],[1,"title"],[1,"toolbar-option-spacer"],["type","button","mat-icon-button","",3,"click"],[1,"sidenav-toggle-icon"]],template:function(l,s){1&l&&(t.\u0275\u0275projectionDef(),t.\u0275\u0275elementStart(0,"mat-toolbar"),t.\u0275\u0275template(1,I,3,0,"button",0),t.\u0275\u0275template(2,v,3,0,"button",0),t.\u0275\u0275elementStart(3,"span",1),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(5,"span",2),t.\u0275\u0275projection(6),t.\u0275\u0275elementEnd()),2&l&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",s.isHandset&&!s.canGoBack),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",s.isHandset&&s.canGoBack),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(s.title))},dependencies:[c.O5,p.RK,O.Hw,h.Ye],styles:["mat-toolbar[_ngcontent-%COMP%]{background:linear-gradient(300deg,#d69213 40%,#d89c2a 100%);z-index:9999}mat-toolbar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], mat-toolbar[_ngcontent-%COMP%]   .sidenav-toggle-icon[_ngcontent-%COMP%]{color:#fff}mat-toolbar[_ngcontent-%COMP%]   .reserbiz-logo[_ngcontent-%COMP%]{display:none}mat-toolbar[_ngcontent-%COMP%]   .toolbar-option-spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-toolbar[_ngcontent-%COMP%]   .toolbar-option[_ngcontent-%COMP%]{color:#fff}@media (max-width: 425px){mat-toolbar[_ngcontent-%COMP%]   .reserbiz-logo[_ngcontent-%COMP%]{width:40px;display:block}}"]})}return e})()}}]);