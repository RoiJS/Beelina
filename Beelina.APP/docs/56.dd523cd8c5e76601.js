"use strict";(self.webpackChunkBeelina_APP=self.webpackChunkBeelina_APP||[]).push([[56],{4429:(T,h,e)=>{e.r(h),e.d(h,{CustomerModule:()=>at});var s=e(4221),l=e(5154),u=e(9515),v=e(617),E=e(7988),y=e(3680),g=e(2741),c=e(6814),C=e(4190),p=e(1675),O=e(6347),x=e(2928),A=e(9014),R=e(803);class L extends R.y{constructor(d,o){super(d),this.store=d,this.barangayName=o,this.store.dispatch(p.q0({barangayName:o})),this._subscription.add(this.store.pipe((0,s.select)(x.KF)).subscribe(r=>{this._dataStream.next(r)}))}fetchData(){this.store.dispatch(p.q0({barangayName:this.barangayName}))}}var G=e(8897),t=e(5879),D=e(3659),B=e(5253),N=e(2939),F=e(6610),U=e(7673),j=e(3427),V=e(3018),$=e(5180);function b(n,d){if(1&n){const o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",18),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(o);const a=t.\u0275\u0275nextContext().$implicit,i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.deleteStore(a.id))}),t.\u0275\u0275elementStart(1,"mat-icon"),t.\u0275\u0275text(2,"delete"),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd()}2&n&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,1,"GENERAL_TEXTS.REMOVE")," "))}function X(n,d){if(1&n){const o=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div")(1,"div",10)(2,"div",11),t.\u0275\u0275listener("click",function(){const i=t.\u0275\u0275restoreView(o).$implicit,m=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(m.openDetails(i.id))}),t.\u0275\u0275elementStart(3,"div",12)(4,"mat-icon"),t.\u0275\u0275text(5,"store"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(6,"div",13),t.\u0275\u0275listener("click",function(){const i=t.\u0275\u0275restoreView(o).$implicit,m=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(m.openDetails(i.id))}),t.\u0275\u0275elementStart(7,"label",14),t.\u0275\u0275text(8),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"label"),t.\u0275\u0275text(10),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(11,"div",15)(12,"mat-icon",16),t.\u0275\u0275text(13,"more_vert"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"mat-menu",null,17)(16,"button",18),t.\u0275\u0275listener("click",function(){const i=t.\u0275\u0275restoreView(o).$implicit,m=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(m.openDetails(i.id))}),t.\u0275\u0275elementStart(17,"mat-icon"),t.\u0275\u0275text(18,"border_color"),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(19),t.\u0275\u0275pipe(20,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(21,b,5,3,"button",19),t.\u0275\u0275elementEnd()()()()}if(2&n){const o=d.$implicit,r=t.\u0275\u0275reference(15);t.\u0275\u0275advance(8),t.\u0275\u0275textInterpolate(o.name),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(o.address),t.\u0275\u0275advance(2),t.\u0275\u0275property("matMenuTriggerFor",r),t.\u0275\u0275advance(7),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(20,5,"GENERAL_TEXTS.EDIT")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",o.isDeletable)}}const H=[{path:"",component:(()=>{class n extends G.H{constructor(o,r,a,i,m,M,f){super(),this.activatedRoute=o,this.customerStoreService=r,this.dialogService=a,this.router=i,this.store=m,this.snackBarService=M,this.translateService=f,this._barangay=this.activatedRoute.snapshot.paramMap.get("barangay"),this._dataSource=new L(this.store,this._barangay),this.$isLoading=this.store.pipe((0,s.select)(x.VO))}ngOnInit(){}ngOnDestroy(){this.store.dispatch(p.IT()),this.store.dispatch(O.uZ())}openDetails(o){this.router.navigate([`barangays/${this._barangay}/${o}`])}deleteStore(o){this.dialogService.openConfirmation(this.translateService.instant("CUSTOMERS_PAGE.DELETE_CUSTOMER_DIALOG.TITLE"),this.translateService.instant("CUSTOMERS_PAGE.DELETE_CUSTOMER_DIALOG.CONFIRM")).subscribe(r=>{r===A.E.YES&&this.customerStoreService.deleteCustomer(o).subscribe({next:()=>{this.snackBarService.open(this.translateService.instant("CUSTOMERS_PAGE.DELETE_CUSTOMER_DIALOG.SUCCESS_MESSAGE"),this.translateService.instant("GENERAL_TEXTS.CLOSE"),{duration:5e3}),this.store.dispatch(p.IT()),this.store.dispatch(p.n3())},error:()=>{this.snackBarService.open(this.translateService.instant("CUSTOMERS_PAGE.DELETE_CUSTOMER_DIALOG.ERROR_MESSAGE"),this.translateService.instant("GENERAL_TEXTS.CLOSE"),{duration:5e3})}})})}addCustomer(){this.router.navigate([`/barangays/${this._barangay}/add-customer`])}onSearch(o){this.store.dispatch(p.IT()),this.store.dispatch(p.et({keyword:o})),this.store.dispatch(p.q0({barangayName:this._barangay}))}onGoBack(){this.router.navigate(["/barangays"])}get dataSource(){return this._dataSource}get barangay(){return this._barangay}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(C.gz),t.\u0275\u0275directiveInject(D.L),t.\u0275\u0275directiveInject(B.x),t.\u0275\u0275directiveInject(C.F0),t.\u0275\u0275directiveInject(s.Store),t.\u0275\u0275directiveInject(N.ux),t.\u0275\u0275directiveInject(u.sK))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-customer"]],features:[t.\u0275\u0275InheritDefinitionFeature],decls:17,vars:16,consts:[[3,"overrideBackAction","title","onGoBackOverride"],[3,"busy"],[1,"page-container","slide-in-left-animation"],[1,"page-container__page-divider","scale-in-center-animation"],[1,"page-information-description"],[3,"placeHolderTextIdentifier","onSearch"],[3,"templateType","count"],["itemSize","10",1,"list-container","customer-list"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"icon","tapButton"],["matRipple","",1,"list-container__item-section"],[1,"list-container__icon-section","list-container__icon-section--right-space",3,"click"],[1,"list-container__icon-section--icon-container"],[1,"list-container__details-section",3,"click"],[1,"main-label"],[1,"list-container__options-section"],["matRipple","",1,"option",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"app-tool-bar",0),t.\u0275\u0275listener("onGoBackOverride",function(){return a.onGoBack()}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(1,"app-loader-layout",1),t.\u0275\u0275pipe(2,"async"),t.\u0275\u0275elementStart(3,"div",2)(4,"div",3)(5,"label"),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(8,"br"),t.\u0275\u0275elementStart(9,"span",4),t.\u0275\u0275text(10),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(12,"app-search-field",5),t.\u0275\u0275listener("onSearch",function(m){return a.onSearch(m)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(13,"app-list-container",6)(14,"cdk-virtual-scroll-viewport",7),t.\u0275\u0275template(15,X,22,7,"div",8),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(16,"app-floating-button",9),t.\u0275\u0275listener("tapButton",function(){return a.addCustomer()}),t.\u0275\u0275elementEnd()()),2&r&&(t.\u0275\u0275property("overrideBackAction",!0)("title",a.barangay),t.\u0275\u0275advance(1),t.\u0275\u0275property("busy",t.\u0275\u0275pipeBind1(2,10,a.$isLoading)),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(7,12,"CUSTOMERS_PAGE.TITLE")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(11,14,"CUSTOMERS_PAGE.DESCRIPTION")),t.\u0275\u0275advance(2),t.\u0275\u0275property("placeHolderTextIdentifier","CUSTOMERS_PAGE.SEARCH_TEXT_FIELD.PLACEHOLDER"),t.\u0275\u0275advance(1),t.\u0275\u0275property("templateType",a.emptyEntityTemplateEnum.CUSTOMERS)("count",a.dataSource.itemCount),t.\u0275\u0275advance(2),t.\u0275\u0275property("cdkVirtualForOf",a.dataSource),t.\u0275\u0275advance(1),t.\u0275\u0275property("icon","add"))},dependencies:[c.O5,F.l,U.X,j.o,V.w,$.r,v.Hw,E.VK,E.OP,E.p6,y.wG,g.xd,g.x0,g.N7,c.Ov,u.X$],styles:[".customer-list[_ngcontent-%COMP%]{height:75vh}"]})}return n})(),title:"CUSTOMERS_PAGE.TITLE"},{path:"add-customer",loadChildren:()=>Promise.all([e.e(630),e.e(246)]).then(e.bind(e,5246)).then(n=>n.AddCustomerDetailsModule)},{path:":id",loadChildren:()=>Promise.all([e.e(630),e.e(921)]).then(e.bind(e,3921)).then(n=>n.EditCustomerModule)}];let K=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({imports:[C.Bz.forChild(H),C.Bz]})}return n})();var z=e(2812),W=e(1710),Y=e(4664),P=e(7398),Q=e(6306),Z=e(2096),S=e(5190),I=e(8539),J=e(8180),k=e(3100);const w=I.Ps`
  query ($cursor: String) {
    paymentMethods(after: $cursor) {
      edges {
        cursor
        node {
          name
        }
      }
      nodes {
        id
        name
      }
      pageInfo {
        endCursor
        hasNextPage
        hasPreviousPage
        startCursor
      }
    }
  }
`;let q=(()=>{class n{constructor(o,r){this.apollo=o,this.store=r}getPaymentMethods(){let o=null;return this.store.select(k.g2).pipe((0,J.q)(1)).subscribe(r=>o=r),this.apollo.watchQuery({query:w,variables:{cursor:o}}).valueChanges.pipe((0,P.U)(r=>{const a=r.data.paymentMethods,i=r.errors,f=a.nodes;if(f)return{endCursor:a.pageInfo.endCursor,hasNextPage:a.pageInfo.hasNextPage,paymentMethods:f};if(i&&i.length>0)throw new Error(i[0].message);return null}))}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(I._M),t.\u0275\u0275inject(s.Store))};static#e=this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_=(()=>{class n{constructor(o,r){this.actions$=o,this.paymentMethodService=r,this.paymentMethods$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(S.ge),(0,Y.w)(()=>this.paymentMethodService.getPaymentMethods().pipe((0,P.U)(a=>S.Ar({paymentMethods:a.paymentMethods,endCursor:a.endCursor,hasNextPage:a.hasNextPage})),(0,Q.K)(a=>(0,Z.of)(S.gv({error:a.message})))))))}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275inject(l.eX),t.\u0275\u0275inject(q))};static#e=this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}return n})();const tt={isLoading:!1,isUpdateLoading:!1,paymentMethods:new Array,endCursor:null,filterKeyword:"",hasNextPage:!1,error:null},et=(0,s.createReducer)(tt,(0,s.on)(S.ge,(n,d)=>({...n,isLoading:!0})),(0,s.on)(S.Ar,(n,d)=>({...n,isLoading:!1,endCursor:d.endCursor,paymentMethods:n.paymentMethods.concat(d.paymentMethods)})),(0,s.on)(S.gv,(n,d)=>({...n,error:d.error})));var nt=e(179),ot=e(2805),rt=e(6924);let at=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({imports:[c.ez,K,rt._,v.Ps,E.Tx,y.si,g.Cl,s.StoreModule.forFeature("paymentMethods",et),s.StoreModule.forFeature("customerStores",nt.l),s.StoreModule.forFeature("barangays",ot.l),l.sQ.forFeature([z.C,_,W.Y]),u.aw.forChild()]})}return n})()},5190:(T,h,e)=>{e.d(h,{Ar:()=>u,ge:()=>l,gv:()=>v});var s=e(4221);const l=(0,s.createAction)("[Payment Methods] Get Payment Methods"),u=(0,s.createAction)("[Payment Methods] Get Payment Methods Success",(0,s.props)()),v=(0,s.createAction)("[Payment Methods] Get Payment Methods Error",(0,s.props)())},3100:(T,h,e)=>{e.d(h,{Ch:()=>u,g2:()=>v});var s=e(4221);const l=c=>c.paymentMethods,u=(0,s.createSelector)(l,c=>c.paymentMethods),v=(0,s.createSelector)(l,c=>c.endCursor);(0,s.createSelector)(l,c=>c.hasNextPage),(0,s.createSelector)(l,c=>c.isLoading),(0,s.createSelector)(l,c=>c.error)}}]);