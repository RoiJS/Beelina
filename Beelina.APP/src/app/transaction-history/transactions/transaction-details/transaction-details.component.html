<app-tool-bar [title]="transaction?.store?.name"> </app-tool-bar>

<app-loader-layout [busy]="isLoading">
  <div class="page-container">
    <div class="panel transaction-details-panel">
      <div
        class="panel__details-group-panel transaction-details-panel__details-group-panel"
      >
        <div class="panel__header-section">
          {{
            "PRODUCT_CART_PAGE.FORM_CONTROL_SECTION.HEADER_TITLE" | translate
          }}
        </div>
        <div
          class="panel__body-section transaction-details-panel__body-section"
        >
          <div class="product-transaction-amount-information">
            <span>{{
              "PRODUCT_CART_PAGE.FORM_CONTROL_SECTION.INVOICE_NO_CONTROL.LABEL"
                | translate
            }}</span>
            <span>{{ transaction?.invoiceNo }}</span>
          </div>
          <br />
          <mat-divider></mat-divider>

          <mat-list role="list" class="product-transaction-list">
            <mat-list-item
              *ngFor="let item of transaction?.productTransactions"
              role="listitem"
            >
              <div
                [ngClass]="{ unpaid: !item?.isPaid }"
                class="product-transaction-list__item-section"
              >
                <div class="product-transaction-information">
                  <span>
                    ({{
                      "PRODUCTS_CATALOGUE_PAGE.PRODUCT_CARD_ITEM.CODE"
                        | translate
                    }}: {{ item.product?.code }})
                    <br />
                    {{ item.product?.name }}
                  </span>
                  <span>X</span>
                  <span>{{ item.quantity }}</span>
                </div>

                <div class="product-transaction-information-price">
                  <span>{{ item?.priceFormatted }}</span>
                </div>

                <div class="product-transaction-information-status">
                  <span
                    class="product-transaction-information-status--paid"
                    *ngIf="item?.isPaid"
                    >{{ "GENERAL_TEXTS.PAID" | translate }}</span
                  >
                  <span
                    class="product-transaction-information-status--unpaid"
                    *ngIf="!item?.isPaid"
                    >{{ "GENERAL_TEXTS.UNPAID" | translate }}</span
                  >
                </div>
                <mat-divider></mat-divider>
              </div>
            </mat-list-item>
          </mat-list>
          <br />
          <div
            class="product-transaction-amount-information"
            *ngIf="transaction?.productTransactions?.length > 0"
          >
            <span>{{ "GENERAL_TEXTS.BALANCE" | translate }}</span>
            <span>{{ transaction.balanceFormatted }}</span>
          </div>
          <br />
          <div
            class="product-transaction-amount-information"
            *ngIf="transaction?.productTransactions?.length > 0"
          >
            <span>{{ "GENERAL_TEXTS.TOTAL" | translate }}</span>
            <span>{{ transaction.totalFormatted }}</span>
          </div>
        </div>

        <div
          class="panel__footer-section transaction-details-panel__footer-section"
        >
          <button
            mat-raised-button
            color="primary"
            (click)="markTransactionAsPaid()"
            [disabled]="!transaction?.hasUnpaidProductTransaction"
          >
            {{ "GENERAL_TEXTS.MARK_AS_PAID" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</app-loader-layout>
