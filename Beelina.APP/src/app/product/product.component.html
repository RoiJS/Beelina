<app-tool-bar
  [title]="'GENERAL_TEXTS.BEELINA' | translate"
  [showBackButton]="false"
>
  <button
    mat-icon-button
    class="toolbar-option"
    (click)="openTextOrderDialog()"
  >
    <mat-icon matBadgeColor="warn">add_comment</mat-icon>
  </button>
  <button
    mat-icon-button
    [disabled]="itemCounter === 0"
    class="toolbar-option"
    (click)="goToCart()"
  >
    <mat-icon
      [matBadge]="itemCounter"
      [matBadgeHidden]="itemCounter === 0"
      matBadgeColor="warn"
      >shopping_cart</mat-icon
    >
  </button>
  <mat-icon
    matRipple
    [matMenuTriggerFor]="menu"
    *ngIf="currentUserPermission < getPermissionLevel(permissionLevelEnum.Manager)"
    >more_vert</mat-icon
  >
  <mat-menu #menu="matMenu">
    <button
      mat-menu-item
      (click)="openAllowManageProductDetailsDialog()"
      *ngIf="!allowManageProductDetails"
    >
      {{
        "PRODUCTS_CATALOGUE_PAGE.MANAGE_PRODUCT_DETAILS.ACTIVATE_MANAGE_PRODUCT_DETAILS"
          | translate
      }}
    </button>
    <button
      mat-menu-item
      (click)="deactivateAllowManageProductDetailsDialog()"
      *ngIf="allowManageProductDetails"
    >
      {{
        "PRODUCTS_CATALOGUE_PAGE.MANAGE_PRODUCT_DETAILS.DEACTIVATE_MANAGE_PRODUCT_DETAILS"
          | translate
      }}
    </button>
  </mat-menu>
</app-tool-bar>
<app-loader-layout [busy]="$isLoading | async">
  <div class="page-container slide-in-left-animation">
    <div class="page-container__page-divider scale-in-center-animation">
      <label>{{ "PRODUCTS_CATALOGUE_PAGE.TITLE" | translate }}</label
      ><br />
      <span class="page-information-description">{{
        "PRODUCTS_CATALOGUE_PAGE.DESCRIPTION" | translate
      }}</span>
    </div>
    <app-search-field
      (onSearch)="onSearch($event)"
      [placeHolderTextIdentifier]="
        'PRODUCTS_CATALOGUE_PAGE.SEARCH_TEXT_FIELD.PLACEHOLDER'
      "
    ></app-search-field>

    <app-list-container
      [templateType]="emptyEntityTemplateEnum.PRODUCTS"
      [count]="dataSource.itemCount"
    >
      <cdk-virtual-scroll-viewport
        itemSize="30"
        orientation="vertical"
        class="list-container product-list"
      >
        <div *cdkVirtualFor="let item of dataSource">
          <app-product-card-item
            [productItem]="item"
            [allowManageItem]="
              currentUserPermission > getPermissionLevel(permissionLevelEnum.User) ||
              allowManageProductDetails
            "
            (editItem)="editProduct($event)"
            (deleteItem)="deleteProduct($event)"
            (addItem)="addItemToCart($event)"
          ></app-product-card-item>
        </div>
      </cdk-virtual-scroll-viewport>
    </app-list-container>
  </div>

  <app-floating-button
    *ngIf="
      currentUserPermission > getPermissionLevel(permissionLevelEnum.User) ||
      allowManageProductDetails
    "
    (tapButton)="addProduct()"
    [icon]="'add'"
  ></app-floating-button>
</app-loader-layout>
